# EventBus å®Œæ•´æµç¨‹å›¾

## 1ï¸âƒ£ PublishLocal æµç¨‹ - ä»…å†…å­˜å¤„ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·æœåŠ¡                               â”‚
â”‚              (Message Service)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ pub.PublishLocal(ctx, "send_message", data)
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            EventPublisher                               â”‚
â”‚         å‘å¸ƒç®¡ç†å™¨                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ åˆ›å»ºEvent(Source="local")
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            å†…å­˜äº‹ä»¶æ€»çº¿ (EventBus)                        â”‚
â”‚              In-Memory Bus                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚           â”‚           â”‚
         â–¼           â–¼           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Handler1â”‚  â”‚Handler2â”‚  â”‚Handler3â”‚
    â”‚(Worker1)  â”‚(Worker2)  â”‚(Worker3)
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚           â”‚           â”‚
         â–¼           â–¼           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   äº‹ä»¶å¤„ç†å®Œæˆ            â”‚
    â”‚ (æœ¬æœåŠ¡å†…)                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹ï¼š
âœ… é«˜é€Ÿ (<1ms)
âœ… ä¸æ¶‰åŠMQ
âœ… å®Œå…¨åœ¨å†…å­˜ä¸­
âœ… ä»…æœ¬æœåŠ¡å¤„ç†
```

---

## 2ï¸âƒ£ PublishDistributed æµç¨‹ - è·¨æœåŠ¡é€šä¿¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Order æœåŠ¡                               â”‚
â”‚           (Order Service)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
     pub.PublishDistributed(ctx, "order.created", data)
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            EventPublisher                                â”‚
â”‚           (å‘å¸ƒç®¡ç†å™¨)                                   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                          â”‚
     â”‚                                          â”‚
å‘é€MQ(å¼‚æ­¥)                          å‘é€å†…å­˜(åŒæ­¥)
     â”‚                                          â”‚
     â–¼                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RabbitMQ       â”‚                  â”‚  å†…å­˜æ€»çº¿(EventBus)   â”‚
â”‚  Exchange       â”‚                  â”‚  In-Memory Bus       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                      â”‚
         â”‚ (å¼‚æ­¥è½¬å‘)                            â”‚ (åŒæ­¥)
         â”‚                                      â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚            â”‚            â”‚              â”‚  â”‚
    â–¼            â–¼            â–¼              â–¼  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚åº“å­˜æœåŠ¡ â”‚ â”‚æ”¯ä»˜æœåŠ¡ â”‚ â”‚é€šçŸ¥æœåŠ¡ â”‚    â”‚æœ¬æœåŠ¡   â”‚
â”‚Inventoryâ”‚ â”‚Payment â”‚ â”‚Notice  â”‚    â”‚Handler â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚            â”‚            â”‚              â”‚
    â”‚            â”‚            â”‚              â”‚
å¼‚æ­¥å¤„ç†      å¼‚æ­¥å¤„ç†      å¼‚æ­¥å¤„ç†       ç«‹å³å¤„ç†
   100ms        150ms        200ms          1ms
    â”‚            â”‚            â”‚              â”‚
    â–¼            â–¼            â–¼              â–¼
  å¤„ç†          å¤„ç†          å¤„ç†          å®Œæˆ
  å®Œæˆ          å®Œæˆ          å®Œæˆ

æ—¶åºï¼š
T0+0:   æœ¬æœåŠ¡æ”¶åˆ°è¯·æ±‚
T0+:    MQå‘é€(ä¸é˜»å¡)
T0+1:   æœ¬æœåŠ¡å¤„ç† CreateSnapshotHandler
T0+100: åº“å­˜æœåŠ¡æ¥æ”¶å¹¶å¤„ç†
T0+150: æ”¯ä»˜æœåŠ¡æ¥æ”¶å¹¶å¤„ç†
T0+200: é€šçŸ¥æœåŠ¡æ¥æ”¶å¹¶å¤„ç†
T0+500: æ‰€æœ‰æµç¨‹å®Œæˆ

ç‰¹ç‚¹ï¼š
âœ… æœ¬æœåŠ¡ç«‹å³å¤„ç† (1ms)
âœ… å…¶ä»–æœåŠ¡å¼‚æ­¥å¤„ç† (100-500ms)
âœ… MQæŒä¹…åŒ–
âœ… è·¨æœåŠ¡é€šä¿¡
âœ… é€‚åˆå…³é”®ä¸šåŠ¡
```

---

## 3ï¸âƒ£ PublishToMQOnly æµç¨‹ - ä»…è§¦å‘å¤–éƒ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Analytics æœåŠ¡                              â”‚
â”‚            (Analytics Service)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        pub.PublishToMQOnly(ctx, "send_email", data)
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            EventPublisher                                â”‚
â”‚           (å‘å¸ƒç®¡ç†å™¨)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ å‘é€åˆ°MQ
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              RabbitMQ                                    â”‚
â”‚           (Message Queue)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ (ä¸åœ¨æœ¬æœåŠ¡å¤„ç†ï¼)
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           é‚®ä»¶æœåŠ¡                                        â”‚
â”‚       (Notification Service)                            â”‚
â”‚          - ç›‘å¬MQ                                        â”‚
â”‚          - æ¶ˆè´¹é‚®ä»¶äº‹ä»¶                                  â”‚
â”‚          - å‘é€é‚®ä»¶                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‰¹ç‚¹ï¼š
âœ… ä»…é€šè¿‡MQè½¬å‘
âœ… æœ¬æœåŠ¡ä¸å¤„ç†
âœ… å®Œå…¨å¼‚æ­¥
âœ… é€‚åˆåå°ä»»åŠ¡
âœ… ä½è€¦åˆ
```

---

## 4ï¸âƒ£ AMQPListener ç›‘å¬æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              RabbitMQ                                    â”‚
â”‚         (å…¶ä»–æœåŠ¡å‘æ¥çš„æ¶ˆæ¯)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ æ¶ˆæ¯åˆ°è¾¾
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AMQPListener                                  â”‚
â”‚          (AMQPç›‘å¬å™¨)                                    â”‚
â”‚         å¯åŠ¨: listener.StartListener(ctx)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                       â”‚
         â”‚ subscribe()                           â”‚
         â”‚ ç›‘å¬RabbitMQ                         â”‚
         â”‚                                       â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚  æ¶ˆæ¯æ¥æ”¶å¾ªç¯              â”‚               â”‚
    â”‚  Message Loop              â”‚               â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
         â”‚                                      â”‚
         â”‚ æ–°æ¶ˆæ¯åˆ°è¾¾                            â”‚
         â”‚                                      â”‚
         â–¼                                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚  æ¶ˆæ¯è½¬æ¢                  â”‚               â”‚
    â”‚  Message â†’ Event          â”‚               â”‚
    â”‚  Source="amqp"æ ‡è®°        â”‚ â† å…³é”®ï¼
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
         â”‚                                      â”‚
         â–¼                                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚  å‘å¸ƒåˆ°å†…å­˜æ€»çº¿           â”‚               â”‚
    â”‚  eventBus.Publish()       â”‚               â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
         â”‚                                      â”‚
         â–¼                                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚  æœ¬æœåŠ¡å¤„ç†               â”‚               â”‚
    â”‚  Handlerå¤„ç†              â”‚               â”‚
    â”‚  (å†…å­˜ä¸­ï¼Œé«˜é€Ÿ)           â”‚               â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
         â”‚                                      â”‚
         â–¼                                      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚  å¤„ç†å®Œæˆ                  â”‚               â”‚
    â”‚  âœ… ä¸ä¼šå†å‘å›MQ          â”‚ â† å…³é”®ï¼
    â”‚     (æ— å¾ªç¯)              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
                                               â”‚
                                    ç­‰å¾…ä¸‹ä¸€æ¡æ¶ˆæ¯
                                        â†‘ â”‚
                                        â””â”€â”˜

å…³é”®ç‚¹ï¼š
âœ… å•å‘æµï¼šMQ â†’ å†…å­˜ â†’ å¤„ç†
âœ… Source="amqp" æ ‡è®°
âœ… ä¸ä¼šå¾ªç¯å›MQ
âœ… å®Œå…¨å•å‘è®¾è®¡
```

---

## 5ï¸âƒ£ å®Œæ•´ç³»ç»Ÿæ¶æ„æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        äº‹ä»¶å‘å¸ƒä¾§                                    â”‚
â”‚                    (Event Publishing)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚          â”‚              â”‚
       â”‚          â”‚              â”‚
       â–¼          â–¼              â–¼
   æœ¬åœ°äº‹ä»¶    åˆ†å¸ƒå¼äº‹ä»¶       MQä¸“ç”¨äº‹ä»¶
   Local      Distributed      MQOnly
       â”‚          â”‚              â”‚
       â”‚          â”‚              â”‚
   PublishLocal PublishDistributed PublishToMQOnly
       â”‚          â”‚  â”‚            â”‚
       â”‚          â”‚  â”‚            â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚  â”‚    â”‚
                  â–¼  â–¼    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   RabbitMQ (MQå±‚)       â”‚
        â”‚   Message Queue         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
        â–¼                 â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ å…¶ä»–æœåŠ¡    â”‚   â”‚ AMQPListener     â”‚
   â”‚ (Async)    â”‚   â”‚ (æœ¬æœåŠ¡ç›‘å¬)      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚
        â”‚                  è½¬æ¢Event
        â”‚              Source="amqp"
        â”‚                     â”‚
        â”‚                     â–¼
        â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚ å†…å­˜äº‹ä»¶æ€»çº¿          â”‚
        â”‚            â”‚ EventBus             â”‚
        â”‚            â”‚ In-Memory Bus        â”‚
        â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚
        â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    â”‚        â”‚       â”‚        â”‚           â”‚
        â”‚    â–¼        â–¼       â–¼        â–¼           â–¼
        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ â”‚Handlerâ”‚â”‚Handler â”‚â”‚Handler â”‚â”‚ä¸­é—´ä»¶ â”‚â”‚ä¸­é—´ä»¶ â”‚
        â”‚ â”‚ Pool1 â”‚â”‚ Pool2  â”‚â”‚ Pool3  â”‚â”‚Chain  â”‚â”‚Chain  â”‚
        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚    â”‚        â”‚       â”‚        â”‚           â”‚
        â”‚    â”‚        â”‚       â”‚        â”‚           â”‚
        â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚
        â”‚                     â–¼
        â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚  äº‹ä»¶å¤„ç†å®Œæˆ      â”‚
        â”‚            â”‚ Event Processed  â”‚
        â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â””â”€â”€â†’ å…¶ä»–æœåŠ¡å¼‚æ­¥å¤„ç†
```

---

## 6ï¸âƒ£ äº‹ä»¶ç”Ÿå‘½å‘¨æœŸå®Œæ•´æµç¨‹

```
äº‹ä»¶åˆ›å»ºé˜¶æ®µ
â”œâ”€ 1. ç”¨æˆ·è°ƒç”¨ Publisher.PublishXxx()
â”œâ”€ 2. åˆ›å»º Event å¯¹è±¡
â”‚  â”œâ”€ Id: UUID (å”¯ä¸€æ ‡è¯†)
â”‚  â”œâ”€ Topic: string (ä¸»é¢˜)
â”‚  â”œâ”€ Payload: any (æ•°æ®)
â”‚  â””â”€ Source: string (æ¥æºæ ‡è®°) â† å…³é”®
â”œâ”€ 3. æ ¹æ®å‘å¸ƒæ–¹å¼:
â”‚  â”œâ”€ PublishLocal â†’ Source="local"
â”‚  â”œâ”€ PublishDistributed â†’ Source="service"
â”‚  â””â”€ PublishToMQOnly â†’ Source="service"
â””â”€ 4. è®°å½•æ—¥å¿—

        â†“

äº‹ä»¶åˆ†å‘é˜¶æ®µ(å†…å­˜)
â”œâ”€ 1. å‘é€åˆ°å†…å­˜æ€»çº¿ (EventBus)
â”œâ”€ 2. ç»è¿‡ä¸­é—´ä»¶é“¾:
â”‚  â”œâ”€ LoggingPlugin (è®°å½•)
â”‚  â”œâ”€ RecoverPlugin (æ¢å¤)
â”‚  â”œâ”€ FilterPlugin (è¿‡æ»¤)
â”‚  â””â”€ TransformPlugin (è½¬æ¢)
â”œâ”€ 3. åˆ†å‘åˆ°è®¢é˜…é€šé“
â”œâ”€ 4. æ¶ˆè´¹è€…æ± å¤„ç†
â”‚  â””â”€ Nä¸ªWorkerå¹¶å‘å¤„ç†
â””â”€ 5. è®°å½•æ—¥å¿—

        â†“

äº‹ä»¶åˆ†å‘é˜¶æ®µ(MQ)
â”œâ”€ ä»…é™ PublishDistributed / PublishToMQOnly
â”œâ”€ 1. å¼‚æ­¥å‘é€åˆ°RabbitMQ
â”œâ”€ 2. RabbitMQæŒä¹…åŒ–
â”œâ”€ 3. å…¶ä»–æœåŠ¡ç›‘å¬æ¶ˆè´¹
â””â”€ 4. è®°å½•æ—¥å¿—

        â†“

äº‹ä»¶æ¥æ”¶é˜¶æ®µ(æ¥è‡ªMQ)
â”œâ”€ ä»…é™ AMQPListener
â”œâ”€ 1. ä»RabbitMQæ¥æ”¶æ¶ˆæ¯
â”œâ”€ 2. æ¶ˆæ¯ååºåˆ—åŒ–
â”œâ”€ 3. è½¬æ¢ä¸ºEventå¯¹è±¡
â”œâ”€ 4. æ ‡è®° Source="amqp" â† å…³é”®é˜²å¾ªç¯
â”œâ”€ 5. å‘é€åˆ°å†…å­˜æ€»çº¿
â””â”€ 6. è®°å½•æ—¥å¿—

        â†“

äº‹ä»¶å¤„ç†é˜¶æ®µ
â”œâ”€ 1. Handler å¤„ç†
â”œâ”€ 2. ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ
â”œâ”€ 3. é”™è¯¯å¤„ç† & Panicæ¢å¤
â”œâ”€ 4. è®°å½•ç»“æœæ—¥å¿—
â””â”€ 5. äº‹ä»¶å¤„ç†å®Œæˆ

        â†“

æ¸…ç†/æŒä¹…åŒ–
â”œâ”€ 1. æ¶ˆè´¹è€…æ± ç»§ç»­å¾…å‘½
â”œâ”€ 2. å¦‚éœ€æŒä¹…åŒ– â†’ EventStore.SaveEvent()
â”œâ”€ 3. æ ‡è®°å·²å¤„ç† â†’ EventStore.MarkAsProcessed()
â””â”€ 4. æ¸…ç†å®Œæˆ
```

---

## 7ï¸âƒ£ é˜²å¾ªç¯æœºåˆ¶æµç¨‹å›¾

```
é—®é¢˜åœºæ™¯ï¼ˆæ—§è®¾è®¡ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·å‘å¸ƒäº‹ä»¶    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è‡ªåŠ¨æ‹¦æˆªä¸­é—´ä»¶å‘é€MQ   â”‚ â† è‡ªåŠ¨è¡Œä¸º
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RabbitMQ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä»MQæ¥æ”¶               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å†æ¬¡è§¦å‘ä¸­é—´ä»¶         â”‚ â† è‡ªåŠ¨è¡Œä¸º
â”‚ å†æ¬¡å‘é€MQ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â†’ æ­»å¾ªç¯ï¼âŒ
         â”‚
         â””â”€â”€â†’ æ— é™é‡å¤

è§£å†³æ–¹æ¡ˆï¼ˆæ–°è®¾è®¡ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æ˜ç¡®é€‰æ‹©   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         â”‚
    â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PublishLocal â”‚         â”‚PublishDist. â”‚
â”‚ ä»…å†…å­˜      â”‚         â”‚ å†…å­˜+MQ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
    â”‚                          â”‚
    â”‚                          â–¼
    â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                   â”‚ å‘é€åˆ°MQ        â”‚
    â”‚                   â”‚ (å¼‚æ­¥, ä¸é˜»å¡)  â”‚
    â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                            â”‚
    â”‚                            â–¼
    â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                   â”‚ ä»MQæ¥æ”¶        â”‚
    â”‚                   â”‚ Source="amqp"   â”‚ â† æ ‡è®°ï¼
    â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                            â”‚
    â”‚                            â–¼
    â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                   â”‚ æ£€æŸ¥ Source     â”‚
    â”‚                   â”‚ "amqp"? â†’ ä¸ç»§ç»­â”‚ â† é˜²æŠ¤ï¼
    â”‚                   â”‚ ä»…æœ¬åœ°å¤„ç†      â”‚
    â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ å¤„ç†å®Œæˆ         â”‚
        â”‚ âœ… æ— å¾ªç¯        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…³é”®ç‚¹ï¼š
1ï¸âƒ£ ç”¨æˆ·æ˜¾å¼é€‰æ‹©å‘å¸ƒæ–¹å¼ (ä¸è‡ªåŠ¨)
2ï¸âƒ£ æ¯ä¸ªäº‹ä»¶æ ‡è®°æ¥æº (Source)
3ï¸âƒ£ MQæ¥çš„äº‹ä»¶æ ‡è®°ä¸º "amqp"
4ï¸âƒ£ ä¸å†å‘é€ Source="amqp" çš„äº‹ä»¶åˆ°MQ
5ï¸âƒ£ å®Œå…¨æ¶ˆé™¤å¾ªç¯ï¼
```

---

## 8ï¸âƒ£ ä¸‰ç§å‘å¸ƒæ¨¡å¼å¯¹æ¯”æµç¨‹

```
å†³ç­–æ ‘ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ äº‹ä»¶éœ€è¦è·¨æœåŠ¡å¤„ç†å—ï¼Ÿ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                â”‚
        å¦               æ˜¯
         â”‚                â”‚
         â”‚                â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä»…æœ¬æœåŠ¡ â”‚       â”‚ æ¶‰åŠå…¶ä»–æœåŠ¡       â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ æœ¬æœåŠ¡éœ€è¦  â”‚    â”‚ æœ¬æœåŠ¡æ˜¯å¦ä¹Ÿè¦    â”‚
    â”‚ ç«‹å³å¤„ç†ï¼Ÿ  â”‚    â”‚ ç«‹å³å¤„ç†ï¼Ÿ        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚   â”‚             â”‚          â”‚
        æ˜¯  å¦            æ˜¯          å¦
         â”‚   â”‚             â”‚          â”‚
         â”‚   â”‚             â”‚          â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â–¼â”€â”€â”      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚PublishLocal        â”‚PublishDist.  â”‚PublishToMQâ”‚
    â”‚ä»…å†…å­˜    â”‚      â”‚MQ+å†…å­˜  â”‚  â”‚ä»…MQ     â”‚
    â”‚<1ms    â”‚      â”‚<5ms     â”‚  â”‚<5ms    â”‚
    â”‚é«˜é€Ÿ    â”‚      â”‚è·¨æœåŠ¡   â”‚  â”‚åå°    â”‚
    â”‚å•æœåŠ¡  â”‚      â”‚å³æ—¶+å¼‚æ­¥ â”‚  â”‚å¼‚æ­¥    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æµç¨‹å›¾ï¼š

    PublishLocal()
        â”‚
        â””â”€â†’ EventPublisher
            â””â”€â†’ NewEvent(Source="local")
                â””â”€â†’ eventBus.Publish()
                    â””â”€â†’ å†…å­˜æ€»çº¿åˆ†å‘
                        â””â”€â†’ Handlerså¤„ç† (å¹¶å‘)
                            â””â”€â†’ å®Œæˆ

    PublishDistributed()
        â”‚
        â”œâ”€â†’ EventPublisher
        â”‚   â”œâ”€â†’ NewEvent(Source="service")
        â”‚   â”œâ”€â†’ å¼‚æ­¥å‘é€MQ
        â”‚   â”‚   â””â”€â†’ RabbitMQæŒä¹…åŒ–
        â”‚   â”‚       â””â”€â†’ å…¶ä»–æœåŠ¡æ¶ˆè´¹
        â”‚   â”‚
        â”‚   â””â”€â†’ åŒæ­¥å‘é€å†…å­˜
        â”‚       â””â”€â†’ å†…å­˜æ€»çº¿åˆ†å‘
        â”‚           â””â”€â†’ æœ¬æœåŠ¡Handlerså¤„ç† (ç«‹å³)
        â”‚               â””â”€â†’ å®Œæˆ

    PublishToMQOnly()
        â”‚
        â””â”€â†’ EventPublisher
            â””â”€â†’ NewEvent(Source="service")
                â””â”€â†’ å‘é€MQ
                    â””â”€â†’ RabbitMQæŒä¹…åŒ–
                        â””â”€â†’ å…¶ä»–æœåŠ¡æ¶ˆè´¹
                            â””â”€â†’ å®Œæˆ (æœ¬æœåŠ¡æ— å¤„ç†)
```

---

## 9ï¸âƒ£ å®Œæ•´ç«¯åˆ°ç«¯æµç¨‹ï¼ˆè®¢å•æœåŠ¡ä¾‹å­ï¼‰

```
æ—¶åˆ» T0:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·åˆ›å»ºè®¢å•     â”‚
â”‚ APIè¯·æ±‚åˆ°è¾¾      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
T0+0ms:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ pub.PublishDistributed(              â”‚
â”‚   ctx, "order.created", orderData)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
         â”‚                           â”‚
    å‘é€MQ(å¼‚æ­¥)              å‘é€å†…å­˜(åŒæ­¥)
    ä¸é˜»å¡                     ç«‹å³è¿”å›
         â”‚                           â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ RabbitMQ      â”‚          â”‚å†…å­˜æ€»çº¿        â”‚
    â”‚å‡†å¤‡æ¶ˆæ¯       â”‚          â”‚åˆ†å‘äº‹ä»¶        â”‚
    â”‚              â”‚          â”‚               â”‚
    â”‚Exchange      â”‚          â”‚CreateSnapshot â”‚
    â”‚ Queue        â”‚          â”‚Handler        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                         â”‚
T0+1ms:  â”‚                         â”‚
         â”‚                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚åˆ›å»ºè®¢å•å¿«ç…§    â”‚
         â”‚                    â”‚- ä¿å­˜æ•°æ®      â”‚
         â”‚                    â”‚- è®°å½•æ—¥å¿—      â”‚
         â”‚                    â”‚å¤„ç†æ—¶é—´: 0.5msâ”‚
         â”‚                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                         â”‚
T0+2ms:  â”‚                         â–¼
         â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                    â”‚è¿”å›APIç»“æœ   â”‚
         â”‚                    â”‚å“åº”ç”¨æˆ·200 OKâ”‚
         â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
T0+100ms:â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚åº“å­˜æœåŠ¡æ¶ˆè´¹      â”‚
    â”‚- æ¥æ”¶æ¶ˆæ¯        â”‚
    â”‚- è§£æEvent       â”‚
    â”‚- Source="amqp" âœ…â”‚
    â”‚- æ‰£å‡åº“å­˜        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
T0+150ms:â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚æ”¯ä»˜æœåŠ¡æ¶ˆè´¹      â”‚
    â”‚- æ¥æ”¶æ¶ˆæ¯        â”‚
    â”‚- è§£æEvent       â”‚
    â”‚- Source="amqp" âœ…â”‚
    â”‚- å‘èµ·æ”¯ä»˜        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
T0+200ms:â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚é€šçŸ¥æœåŠ¡æ¶ˆè´¹      â”‚
    â”‚- æ¥æ”¶æ¶ˆæ¯        â”‚
    â”‚- è§£æEvent       â”‚
    â”‚- Source="amqp" âœ…â”‚
    â”‚- å‘é€é€šçŸ¥        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
T0+500ms:
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚æ‰€æœ‰å¼‚æ­¥æµç¨‹å®Œæˆ       â”‚
    â”‚- æ•°æ®ä¸€è‡´æ€§ä¿è¯       â”‚
    â”‚- æœ€ç»ˆä¸€è‡´æ€§è¾¾æˆ       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…³é”®æŒ‡æ ‡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ APIå“åº”æ—¶é—´: T0+2ms âœ… (å¿«é€Ÿ)             â”‚
â”‚ åº“å­˜æ›´æ–°: T0+100ms âœ…                     â”‚
â”‚ æ”¯ä»˜æµç¨‹: T0+150ms âœ…                     â”‚
â”‚ é€šçŸ¥å‘é€: T0+200ms âœ…                     â”‚
â”‚ å¾ªç¯é£é™©: 0 âœ… (Sourceæ ‡è®°é˜²æŠ¤)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Ÿ ä¸­é—´ä»¶é“¾å¤„ç†æµç¨‹

```
å‘å¸ƒäº‹ä»¶
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EventBus.Publish(event)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä¸­é—´ä»¶é“¾å¤„ç†       â”‚ (å¤šå±‚å¤„ç†)
    â”‚ Middleware Chain   â”‚
    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
       â”‚              â”‚
       â”‚ (é¡ºåºæ‰§è¡Œ)   â”‚
       â”‚              â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 1. LoggingPlugin()     â”‚
   â”‚    â”œâ”€ è®°å½•å¼€å§‹æ—¶é—´      â”‚
   â”‚    â”œâ”€ è®°å½•äº‹ä»¶ä¸»é¢˜      â”‚
   â”‚    â””â”€ ç»§ç»­é“¾å¼è°ƒç”¨     â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 2. RecoverPlugin()     â”‚
   â”‚    â”œâ”€ defer recover()  â”‚
   â”‚    â”‚   æ•è·panic       â”‚
   â”‚    â””â”€ ç»§ç»­é“¾å¼è°ƒç”¨     â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 3. FilterPlugin()      â”‚
   â”‚    â”œâ”€ æ£€æŸ¥æ˜¯å¦è¿‡æ»¤      â”‚
   â”‚    â”œâ”€ æ˜¯å¦ä¸­æ­¢å¤„ç†     â”‚
   â”‚    â””â”€ ç»§ç»­é“¾å¼è°ƒç”¨     â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 4. TransformPlugin()   â”‚
   â”‚    â”œâ”€ è½¬æ¢äº‹ä»¶æ•°æ®      â”‚
   â”‚    â”œâ”€ ä¿®æ”¹Payload      â”‚
   â”‚    â””â”€ ç»§ç»­é“¾å¼è°ƒç”¨     â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 5. dispatch()        â”‚ (æ ¸å¿ƒå¤„ç†)
   â”‚    (å†…å­˜åˆ†å‘)        â”‚
   â”‚    â”œâ”€ è·å–è®¢é˜…è€…     â”‚
   â”‚    â”œâ”€ å‘é€åˆ°é€šé“     â”‚
   â”‚    â””â”€ è¿”å›ç»“æœ      â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ (è¿”å›é“¾)
       â”‚
   â—„â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 4. TransformPlugin()   â”‚
   â”‚    â””â”€ åç½®å¤„ç†        â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â—„â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 3. FilterPlugin()      â”‚
   â”‚    â””â”€ åç½®å¤„ç†        â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â—„â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 2. RecoverPlugin()     â”‚
   â”‚    â””â”€ deferå®Œæˆ      â”‚
   â”‚    â””â”€ è¿”å›æˆ–panicæ¢å¤â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
   â—„â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ 1. LoggingPlugin()     â”‚
   â”‚    â”œâ”€ è®¡ç®—è€—æ—¶        â”‚
   â”‚    â”œâ”€ è®°å½•ç»“æŸæ—¶é—´    â”‚
   â”‚    â””â”€ æ‰“å°æ—¥å¿—        â”‚
   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ å¤„ç†å®Œæˆ            â”‚
    â”‚ è¿”å›ç»“æœ            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¸­é—´ä»¶é“¾å¼è°ƒç”¨çš„ä¼˜åŠ¿ï¼š
âœ… èŒè´£åˆ†ç¦»
âœ… æ˜“äºæ‰©å±•
âœ… ä¼˜é›…å¤„ç†
âœ… å¯é…ç½®åŒ–
```

---

## 1ï¸âƒ£1ï¸âƒ£ æ¶ˆè´¹è€…æ± å¹¶å‘å¤„ç†æµç¨‹

```
äº‹ä»¶åˆ°è¾¾
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EventBus.Publish(event)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SubscribeWithPool()              â”‚
â”‚ æ¶ˆè´¹è€…æ±  (workers=10)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ åˆ›å»ºç¼“å†²é˜Ÿåˆ—
           â”‚ queue (capacity=1000)
           â”‚
      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ äº‹ä»¶å…¥é˜Ÿ                      â”‚
      â”‚ queue <- event                â”‚
      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ (é˜Ÿåˆ—ä¸­ç­‰å¾…) â”‚
           â”‚              â”‚
      10ä¸ªworkerå¹¶å‘       â”‚
      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”
      â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”‚
      â–¼  â–¼  â–¼  â–¼  â–¼  â–¼  â–¼  â–¼  â–¼  â–¼

   â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”
   â”‚W-1  â”‚â”‚W-2  â”‚â”‚W-3  â”‚â”‚W-4  â”‚â”‚W-5  â”‚
   â””â”€â”¬â”€â”€â”€â”˜â””â”€â”¬â”€â”€â”€â”˜â””â”€â”¬â”€â”€â”€â”˜â””â”€â”¬â”€â”€â”€â”˜â””â”€â”¬â”€â”€â”€â”˜
     â”‚      â”‚      â”‚      â”‚      â”‚
     â”œâ”€â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚  â”‚ Handlerå¤„ç†         â”‚  â”‚
     â”‚  â”‚ Handle(ctx, event)  â”‚  â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚             â”‚             â”‚
   â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”
   â”‚W-6  â”‚â”‚W-7  â”‚â”‚W-8  â”‚â”‚W-9  â”‚â”‚W-10 â”‚
   â””â”€â”¬â”€â”€â”€â”˜â””â”€â”¬â”€â”€â”€â”˜â””â”€â”¬â”€â”€â”€â”˜â””â”€â”¬â”€â”€â”€â”˜â””â”€â”¬â”€â”€â”€â”˜
     â”‚      â”‚      â”‚      â”‚      â”‚
     â”œâ”€â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚  â”‚ Handlerå¤„ç†         â”‚  â”‚
     â”‚  â”‚ Handle(ctx, event)  â”‚  â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚             â”‚             â”‚

å¹¶å‘æ‰§è¡Œæ—¶é—´è¡¨ï¼š
Time â”‚ W1  â”‚ W2  â”‚ W3  â”‚ W4  â”‚ W5  â”‚ W6  â”‚ W7  â”‚ W8  â”‚ W9  â”‚ W10 â”‚
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
 0ms â”‚å¤„ç† â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚
 1ms â”‚å®Œæˆ â”‚å¤„ç† â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚
 2ms â”‚ç­‰å¾… â”‚å®Œæˆ â”‚å¤„ç† â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚
 3ms â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚å®Œæˆ â”‚å¤„ç† â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚
 4ms â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚å®Œæˆ â”‚å¤„ç† â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚
 5ms â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚å®Œæˆ â”‚å¤„ç† â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚
10ms â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚å®Œæˆ â”‚å¤„ç† â”‚å®Œæˆ â”‚å®Œæˆ â”‚å¤„ç† â”‚
15ms â”‚å¤„ç† â”‚å¤„ç† â”‚å¤„ç† â”‚å®Œæˆ â”‚å®Œæˆ â”‚å®Œæˆ â”‚å®Œæˆ â”‚ç­‰å¾… â”‚ç­‰å¾… â”‚å®Œæˆ â”‚

æ€§èƒ½æ•°æ®ï¼š
- é˜Ÿåˆ—ç¼“å†²: 1000æ¡äº‹ä»¶
- Workeræ•°: 10ä¸ª
- å¤„ç†æ—¶é—´: ~1ms/event
- ååé‡: 100k+/s
- æ€»å¤„ç†æ—¶é—´: 100æ¡äº‹ä»¶ Ã· 10workers Ã· 1ms = 10ms
```

---

## 1ï¸âƒ£2ï¸âƒ£ å®Œæ•´ç³»ç»Ÿæ¶æ„æ€»ä½“æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åº”ç”¨ç³»ç»Ÿæ€»ä½“æ¶æ„                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  ç”¨æˆ·è¯·æ±‚       â”‚
                        â”‚  User Request   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                        â”‚
                    â–¼                        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Message æœåŠ¡  â”‚          â”‚ Order æœåŠ¡    â”‚
            â”‚ (æœ¬åœ°äº‹ä»¶)    â”‚          â”‚ (è·¨æœåŠ¡)      â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                        â”‚
          pub.PublishLocal()     pub.PublishDistributed()
                   â”‚                        â”‚
                   â”‚                   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚                   â”‚              â”‚
                   â–¼                   â–¼              â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚å†…å­˜æ€»çº¿    â”‚      â”‚RabbitMQ   â”‚  â”‚å†…å­˜æ€»çº¿  â”‚
            â”‚In-Memory   â”‚      â”‚MQ         â”‚  â”‚In-Memory â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                 â”‚                   â”‚              â”‚
            â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”      â”‚
            â”‚Handler 1   â”‚       â”‚å…¶ä»–æœåŠ¡   â”‚      â”‚
            â”‚Handler 2   â”‚       â”‚Listeners  â”‚      â”‚
            â”‚Handler 3   â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                           â”‚
                 â”‚                                  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                          â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ å®Œæ•´å†…å­˜æ€»çº¿    â”‚
                          â”‚  Unified Bus  â”‚
                          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           â”‚           â”‚
               â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
               â”‚Handler â”‚  â”‚Handler â”‚  â”‚ä¸­é—´ä»¶  â”‚
               â”‚ Pool   â”‚  â”‚ Pool   â”‚  â”‚Chain   â”‚
               â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                    â”‚           â”‚          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ ä¸šåŠ¡å¤„ç†å®Œæˆ          â”‚
                    â”‚ Business Complete   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å…¶ä»–æœåŠ¡é€šè¿‡MQæ¶ˆè´¹ï¼š
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  å…¶ä»–æœåŠ¡            â”‚
                    â”‚  External Service   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                      AMQPListener
                      ç›‘å¬MQäº‹ä»¶
                             â”‚
                      Source="amqp" âœ“
                             â”‚
                      è½¬å‘åˆ°å†…å­˜æ€»çº¿
                             â”‚
                      æœ¬åœ°å¤„ç†
                             â”‚
                      âœ… ä¸å¾ªç¯å›MQ

ç³»ç»Ÿç‰¹ç‚¹ï¼š
âœ… æœ¬åœ°äº‹ä»¶: é«˜é€Ÿã€å†…å­˜ä¸­ã€ä¸è·¨æœåŠ¡
âœ… è·¨æœåŠ¡äº‹ä»¶: MQ+å†…å­˜ã€å³æ—¶+å¼‚æ­¥
âœ… å¤–éƒ¨è§¦å‘: ä»…MQã€åå°å¤„ç†
âœ… é˜²å¾ªç¯: Sourceæ ‡è®°ã€å•å‘æµå‘
âœ… æ‰©å±•æ€§: æ¶ˆè´¹è€…æ± ã€ä¸­é—´ä»¶é“¾
```

---

è¿™äº›æµç¨‹å›¾å±•ç¤ºäº† EventBus ç³»ç»Ÿçš„å®Œæ•´å·¥ä½œåŸç†ï¼
