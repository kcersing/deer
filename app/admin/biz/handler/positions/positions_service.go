// Code generated by hertz generator.

package positions

import (
	utils2 "admin/biz/infras/utils"
	"admin/rpc/client"
	"common/pkg/errno"
	"context"
	"gen/hertz_gen/positions"
	user2 "gen/kitex_gen/user"

	utils "common/pkg/utils"
	base "gen/hertz_gen/base"

	base1 "gen/kitex_gen/base"

	"github.com/cloudwego/hertz/pkg/app"
)

// CreatePositions .
// @router /service/positions/create [POST]
func CreatePositions(ctx context.Context, c *app.RequestContext) {
	var err error
	var req positions.CreatePositionsReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.UserClient.CreatePositions(ctx, &user2.CreatePositionsReq{
		Name:         req.GetName(),
		Code:         req.GetCode(),
		DepartmentId: req.GetDepartmentId(),
		ParentId:     req.GetParentId(),
		Desc:         req.GetDesc(),
		Status:       req.GetStatus(),
		Quota:        req.GetQuota(),
		CreatedId:    utils2.GetTokenId(ctx, c),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// DeletePositions .
// @router /service/positions/delete [POST]
func DeletePositions(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.IdReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.UserClient.DeletePositions(ctx, &base1.IdReq{Id: req.GetID()})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp, 0, "")
	return
}

// UpdatePositions .
// @router /service/positions/update [POST]
func UpdatePositions(ctx context.Context, c *app.RequestContext) {
	var err error
	var req positions.UpdatePositionsReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}

	resp, err := client.UserClient.UpdatePositions(ctx, &user2.UpdatePositionsReq{
		Id:           req.GetID(),
		Name:         req.GetName(),
		Code:         req.GetCode(),
		DepartmentId: req.GetDepartmentId(),
		ParentId:     req.GetParentId(),
		Desc:         req.GetDesc(),
		Status:       req.GetStatus(),
		Quota:        req.GetQuota(),
		CreatedId:    utils2.GetTokenId(ctx, c),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp, 0, "")
	return
}

// GetPositions .
// @router /service/positions [POST]
func GetPositions(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.IdReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}

	resp, err := client.UserClient.GetPositions(ctx, &base1.IdReq{
		Id: req.GetID(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// GetPositionsList .
// @router /service/positions/list [POST]
func GetPositionsList(ctx context.Context, c *app.RequestContext) {
	var err error
	var req positions.GetPositionsListReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.UserClient.GetPositionsList(ctx, &user2.GetPositionsListReq{
		Page:     req.GetPage(),
		PageSize: req.GetPageSize(),
		Keyword:  req.GetKeyword(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}
