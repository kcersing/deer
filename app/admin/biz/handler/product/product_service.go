// Code generated by hertz generator.

package product

import (
	"gen/hertz_gen/base"

	"github.com/cloudwego/hertz/pkg/protocol/consts"

	utils2 "admin/infras/utils"
	"admin/rpc/client"
	"common/pkg/errno"
	"context"

	product2 "gen/kitex_gen/product"

	"common/pkg/utils"
	product "gen/hertz_gen/product"

	base1 "gen/kitex_gen/base"
	"github.com/cloudwego/hertz/pkg/app"
)

// CreateProduct .
// @router /service/product/create [POST]
func CreateProduct(ctx context.Context, c *app.RequestContext) {
	var err error
	var req product.CreateProductReq
	err = c.BindAndValidate(&req)

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.CreateProduct(ctx, &product2.CreateProductReq{
		Code:        req.GetCode(),
		Name:        req.GetName(),
		Pic:         req.GetPic(),
		Desc:        req.GetDesc(),
		Status:      req.GetStatus(),
		CreatedId:   utils2.GetTokenId(ctx, c),
		Price:       req.GetPrice(),
		Stock:       req.GetStock(),
		IsSales:     req.GetIsSales(),
		SignSalesAt: req.GetSignSalesAt(),
		EndSalesAt:  req.GetEndSalesAt(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp.Data, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// UpdateProduct .
// @router /service/product/update [POST]
func UpdateProduct(ctx context.Context, c *app.RequestContext) {
	var err error
	var req product.UpdateProductReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.UpdateProduct(ctx, &product2.UpdateProductReq{
		Id:          req.GetID(),
		Code:        req.GetCode(),
		Name:        req.GetName(),
		Pic:         req.GetPic(),
		Desc:        req.GetDesc(),
		Status:      req.GetStatus(),
		CreatedId:   utils2.GetTokenId(ctx, c),
		Price:       req.GetPrice(),
		Stock:       req.GetStock(),
		IsSales:     req.GetIsSales(),
		SignSalesAt: req.GetSignSalesAt(),
		EndSalesAt:  req.GetEndSalesAt(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp.Data, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// DeleteProduct .
// @router /service/product/delete [POST]
func DeleteProduct(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.IdReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.DeleteProduct(ctx, &base1.IdReq{Id: req.GetID()})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp, 0, "")
	return
}

// OnlineProduct .
// @router /service/product/online [POST]
func OnlineProduct(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.IdReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.OnlineProduct(ctx, &base1.IdReq{Id: req.GetID()})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp, 0, "")
	return
}

// OfflineProduct .
// @router /service/product/offline [POST]
func OfflineProduct(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.IdReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.OfflineProduct(ctx, &base1.IdReq{Id: req.GetID()})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp, 0, "")
	return
}

// GetProduct .
// @router /service/product [POST]
func GetProduct(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.IdReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}

	resp, err := client.ProductClient.GetProduct(ctx, &base1.IdReq{
		Id: req.GetID(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp.Data, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// SearchProduct .
// @router /service/product/search [POST]
func SearchProduct(ctx context.Context, c *app.RequestContext) {
	var err error
	var req product.SearchProductReq
	err = c.BindAndValidate(&req)
	if err != nil {
		c.String(consts.StatusBadRequest, err.Error())
		return
	}

	resp := new(base.NilResponse)

	c.JSON(consts.StatusOK, resp)
}

// GetProductList .
// @router /service/product/list [POST]
func GetProductList(ctx context.Context, c *app.RequestContext) {
	var err error
	var req product.GetProductListReq
	err = c.BindAndValidate(&req)
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.ProductList(ctx, &product2.ListReq{
		Page:     req.GetPage(),
		PageSize: req.GetPageSize(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp.Data, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// CreateItem .
// @router /service/item/create [POST]
func CreateItem(ctx context.Context, c *app.RequestContext) {
	var err error
	var req product.CreateItemReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.CreateItem(ctx, &product2.CreateItemReq{
		Name:      req.GetName(),
		Pic:       req.GetPic(),
		Desc:      req.GetDesc(),
		Duration:  req.GetDuration(),
		Length:    req.GetLength(),
		Count:     req.GetCount(),
		Type:      req.GetType(),
		Code:      req.GetCode(),
		Price:     req.GetPrice(),
		TagId:     req.GetTagId(),
		CreatedId: utils2.GetTokenId(ctx, c),
		Status:    req.GetStatus(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp.Data, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// UpdateItem .
// @router /service/item/update [POST]
func UpdateItem(ctx context.Context, c *app.RequestContext) {
	var err error
	var req product.UpdateItemReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.UpdateItem(ctx, &product2.UpdateItemReq{
		Id:        req.GetID(),
		Name:      req.GetName(),
		Pic:       req.GetPic(),
		Desc:      req.GetDesc(),
		Duration:  req.GetDuration(),
		Length:    req.GetLength(),
		Count:     req.GetCount(),
		Type:      req.GetType(),
		Code:      req.GetCode(),
		Price:     req.GetPrice(),
		TagId:     req.GetTagId(),
		CreatedId: utils2.GetTokenId(ctx, c),
		Status:    req.GetStatus(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp.Data, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// DeleteItem .
// @router /service/item/delete [POST]
func DeleteItem(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.IdReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.DeleteItem(ctx, &base1.IdReq{Id: req.GetID()})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp, 0, "")
	return
}

// GetItemList .
// @router /service/item/list [POST]
func GetItemList(ctx context.Context, c *app.RequestContext) {
	var err error
	var req product.GetItemListReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}
	resp, err := client.ProductClient.ItemList(ctx, &product2.ItemListReq{
		Page:     req.GetPage(),
		PageSize: req.GetPageSize(),
		//Name:     req.GetName(),
		//Status:   req.GetStatus(),
		//Type:     req.GetType(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp.Data, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}

// GetItem .
// @router /service/item [POST]
func GetItem(ctx context.Context, c *app.RequestContext) {
	var err error
	var req base.IdReq
	err = c.BindAndValidate(&req)
	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), nil, 0, "")
		return
	}

	resp, err := client.ProductClient.GetItem(ctx, &base1.IdReq{
		Id: req.GetID(),
	})

	if err != nil {
		utils.SendResponse(c, errno.ConvertErr(err), resp.Data, 0, "")
		return
	}
	utils.SendResponse(c, errno.Success, resp.Data, 0, "")
	return
}
